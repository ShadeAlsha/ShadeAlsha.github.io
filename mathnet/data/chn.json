{
  "2022": [
    {
      "_provenance": {
        "folder": "CHN_2022e",
        "pages_map": {
          "P0": "page15.md",
          "P1": "page16.md",
          "P2": "page17.md"
        }
      },
      "author": null,
      "booklet title": "CHN_TSExams_2022_3.pdf",
      "booklet_url": null,
      "competition name": null,
      "copyright_info": null,
      "has_solutions": true,
      "id": "p_bd33973e3f62",
      "language": "en",
      "page numbers": [
        0,
        2
      ],
      "solutions": [
        {
          "images": [],
          "label": null,
          "latex": "We first prove the claim: if the screen eventually turns into one color, say blue, then there must be one square which is constantly blue.\n\nSuppose not, namely, suppose that eventually all squares are blue but every square has changed color at some time. We construct an oriented graph $G$ as follows: the vertices are all squares, and we link an oriented arrow $A \\to B$ if $A$ and $B$ are adjacent and there is some time $t_0$ such that square $A$ is not blue at the time $t_0 - 1$ and is constantly blue when $t \\ge t_0$, and square $B$ is blue at the time $t_0 - 1$. In other words, the square $A$ is changed to blue last time because of square $B$. Since we assume that every square on the screen has changed color, every vertex of the graph has out-degree $\\ge 1$. So $G$ must contain an oriented loop $A_1 \\to A_2 \\to \\dots \\to A_k \\to A_1$. Assume that square $A_i$ turns blue for the last time at the time $t_i$, i.e. $A_i$ is not blue at the time $t_i - 1$, and is constantly blue when $t \\ge t_i$. Without loss of generality, $t_1$ is the largest among $t_1, \\dots, t_k$. From the arrow $A_1 \\to A_2$, the square $A_i$ is yellow at time $t_1 - 1$; From the arrow $A_k \\to A_1$, the square $A_1$ is blue at the time $t_k - 1$. We must have $t_k < t_1$. But a blue square can only turn red first before turning yellow. So there exists $t_k < t' < t_1$, such that $A_1$ is red at the time $t' - 1$. But $t' - 1 \\ge t_k$, $A_k$ is blue at the time $t' - 1$, so $A_1$ will force $A_k$ to turn red at the time $t'$. But this contradicts the definition of $t_k$, namely, $A_k$ is constantly blue from the time $t_k$ onward. The claim is proved.\n\nBack to the original problem, assume that all squares are turned blue eventually, we will show that the squares are all turned blue after $2n - 2$ seconds.\n\nBy the claim, there exists a square $A$ which is constantly blue. Define the distance between two squares by the sum of their horizontal and vertical distances; then the distance between farthest two squares is $2n - 2$. If $B$ and $A$ have distance 1, then $B$ can never be red, this means: if $B$ is initially blue, then it is always blue; if $B$ is yellow, then",
          "pages": [
            "P2"
          ],
          "status": "truncated"
        }
      ],
      "statement_images": [],
      "statement_latex": "On a screen formed by $n \\times n$ ($n \\ge 2$) squares, every square displays initially one of the three colors: red, yellow, and blue. Every second, the screen changes the color of each square following the rules below:\n\n* for each square $A$ whose current color is red, if there is a yellow square sharing a side with this square, then $A$ turns yellow in the next second, otherwise, $A$ remains red;\n\n* for each square $B$ whose current color is yellow, if there is a blue square sharing a side with this square, then $B$ turns blue in the next second, otherwise, $B$ remains yellow;\n\n* for each square $C$ whose current color is blue, if there is a red square sharing a side with this square, then $C$ turns red in the next second, otherwise, $C$ remains blue.\n\nProve that if the screen does not change to a single color after $2n - 2$ seconds, then it will never change to a single color."
    },
    {
      "_provenance": {
        "folder": "CHN_2022e",
        "pages_map": {
          "P0": "page15.md",
          "P1": "page16.md",
          "P2": "page17.md"
        }
      },
      "author": null,
      "booklet title": "CHN_TSExams_2022_3.pdf",
      "booklet_url": null,
      "competition name": null,
      "copyright_info": null,
      "has_solutions": true,
      "id": "p_2c318aa1eaee",
      "language": "en",
      "page numbers": [
        0
      ],
      "solutions": [
        {
          "images": [],
          "label": null,
          "latex": "Decompose $D$ into the following disjoint unions $D = X \\sqcup Y \\sqcup Z \\sqcup W$, where\n\n\\[\nX = \\{x \\in D : \\exists a | x, \\exists b | x\\}, \\quad Y = \\{x \\in D : \\exists a | x, \\nexists b | x\\},\n\\]\n\n\\[\nZ = \\{x \\in D : \\nexists a | x, \\exists b | x\\}, \\quad W = \\{x \\in D : \\nexists a | x, \\nexists b | x\\}.\n\\]\n\nNote that the assumption of the problem indicates that $A \\subseteq Y, B \\subseteq Z$. It suffices to prove a stronger statement: for any two nonempty subsets $A, B$ of $D$, we always have $\\sqrt{|Y|} + \\sqrt{|Z|} \\le \\sqrt{|D|}$. This inequality is equivalent to\n\n\\[\n|Y| + |Z| + 2\\sqrt{|Y| \\cdot |Z|} \\le |D| = |X| + |Y| + |Z| + |W| \\iff 2\\sqrt{|Y| \\cdot |Z|} \\le |X| + |W|,\n\\]\n\nThis inequality is implied by $|Y| \\cdot |Z| \\le |X| \\cdot |W|$, which can be further rewritten as\n$$ (|X|+|Y|)(|X|+|Z|) = |X|(|X|+|Y|+|Z|)+|Y|\\cdot|Z| \\le |X|(|X|+|Y|+|Z|)+|X|\\cdot|W| = |X|\\cdot|D|. $$\n\nLet $U = X \\cup Y$ and $V = X \\cup Z$. Then the above inequality becomes $|U| \\cdot |V| \\le |U \\cap V| \\cdot |D|$.\nNote that $U = \\{x \\in D : \\exists a | x\\}$ satisfies: if $x \\in U$ and $x | x'$, then $x' \\in U$. Call such subsets of $D$ upward-closed. Similarly, $V = \\{x \\in D : \\exists b | x\\}$ is also an upward-closed subset of $D$.\n\nNext, we prove: for any two nonempty upward-closed subsets $U, V$ of $D$, we have $|U| \\cdot |V| \\le |U \\cap V| \\cdot |D|$.\n\nLet $n = p_1^{\\alpha_1} \\cdots p_k^{\\alpha_k}$ be the prime factorization of $n$, and we make an induction on $k$. Write $p$ and $\\alpha$ for $p_k$ and $\\alpha_k$, respectively, for simplicity. Set $n = p^{\\alpha}n'$. Define $D_k = \\{x \\in D | v_p(x) = k\\}$, $U_k = U \\cap D_k$, and $V_k = V \\cap D_k$. For every $k = 0, 1, \\dots, \\alpha - 1$, for any $x \\in U_k$, the upward-closure property of $U$ implies that $px \\in U_{k+1}$. This means that $|U_k| \\le |U_{k+1}|$, i.e. $\\{|U_k|\\}_k$ is increasing. Similarly, $\\{|V_k|\\}_k$ is increasing. Note that $\\frac{1}{p^k}U_k$ and $\\frac{1}{p^k}V_k$ are upward-closed subsets of $\\frac{1}{p^k}D_k = D(n')$. But inductive hypothesis, we have\n\n\\[\n|(\\frac{1}{p^k}U_k) \\cap (\\frac{1}{p^k}V_k)| \\ge \\frac{1}{|D(n')|} \\cdot |(\\frac{1}{p^k}U_k)| \\cdot |(\\frac{1}{p^k}V_k)|,\n\\]\n\nSo we have $|U_k \\cap V_k| \\ge \\frac{1+\\alpha}{|D|} |U_k| \\cdot |V_k|$. Using rearrangement inequality, we get\n\n\\[\n\\begin{aligned} |U \\cap V| &= \\sum_{k=0}^{\\alpha} |U_k \\cap V_k| \\ge \\frac{1+\\alpha}{|D|} \\sum_{k=0}^{\\alpha} |U_k| \\cdot |V_k| \\\\ &\\ge \\frac{1+\\alpha}{|D|} \\cdot \\frac{1}{1+\\alpha} \\left( \\sum_{k=0}^{\\alpha} |U_k| \\right) \\cdot \\left( \\sum_{k=0}^{\\alpha} |V_k| \\right) \\\\ &= \\frac{1}{|D|} |U| \\cdot |V|. \\end{aligned}\n\\]\n\nThe problem is proved.",
          "pages": [
            "P0"
          ],
          "status": "complete"
        }
      ],
      "statement_images": [],
      "statement_latex": "Given a positive integer $n$, let $D$ denote the set of all positive divisors of $n$. Let $A$ and $B$ be subsets of $D$ satisfying: for any $a \\in A$ and $b \\in B$, we have $a \\nmid b$ and $b \\nmid a$. Prove that\n\n\\[\n\\sqrt{|A|} + \\sqrt{|B|} \\le \\sqrt{|D|}.\n\\]"
    },
    {
      "_provenance": {
        "folder": "CHN_2022e",
        "pages_map": {
          "P0": "page15.md",
          "P1": "page16.md",
          "P2": "page17.md"
        }
      },
      "author": null,
      "booklet title": "CHN_TSExams_2022_3.pdf",
      "booklet_url": null,
      "competition name": null,
      "copyright_info": null,
      "has_solutions": true,
      "id": "p_7e5f7d289eaf",
      "language": "en",
      "page numbers": [
        0,
        1
      ],
      "solutions": [
        {
          "images": [],
          "label": null,
          "latex": "**Proof:** We first prove the claim: if the screen eventually turns into one color, say blue, then there must be one square which is constantly blue.\n\nSuppose not, namely, suppose that eventually all squares are blue but every square has changed color at some time. We construct an oriented graph $G$ as follows: the vertices are all squares, and we link an oriented arrow $A \\to B$ if $A$ and $B$ are adjacent and there is some time $t_0$ such that square $A$ is not blue at the time $t_0 - 1$ and is constantly blue when $t \\ge t_0$, and square $B$ is blue at the time $t_0 - 1$. In other words, the square $A$ is changed to blue last time because of square $B$. Since we assume that every square on the screen has changed color, every vertex of the graph has out-degree $\\ge 1$. So $G$ must contain an oriented loop $A_1 \\to A_2 \\to \\dots \\to A_k \\to A_1$. Assume that square $A_i$ turns blue for the last time at the time $t_i$, i.e. $A_i$ is not blue at the time $t_i - 1$, and is constantly blue when $t \\ge t_i$. Without loss of generality, $t_1$ is the largest among $t_1, \\dots, t_k$. From the arrow $A_1 \\to A_2$, the square $A_i$ is yellow at time $t_1 - 1$; From the arrow $A_k \\to A_1$, the square $A_1$ is blue at the time $t_k - 1$. We must have $t_k < t_1$. But a blue square can only turn red first before turning yellow. So there exists $t_k < t' < t_1$, such that $A_1$ is red at the time $t' - 1$. But $t' - 1 \\ge t_k$, $A_k$ is blue at the time $t' - 1$, so $A_1$ will force $A_k$ to turn red at the time $t'$. But this contradicts the definition of $t_k$, namely, $A_k$ is constantly blue from the time $t_k$ onward. The claim is proved.\n\nBack to the original problem, assume that all squares are turned blue eventually, we will show that the squares are all turned blue after $2n - 2$ seconds.\n\nBy the claim, there exists a square $A$ which is constantly blue. Define the distance between two squares by the sum of their horizontal and vertical distances; then the distance between farthest two squares is $2n - 2$. If $B$ and $A$ have distance 1, then $B$ can never be red, this means: if $B$ is initially blue, then it is always blue; if $B$ is yellow, then it is turned blue after 1 second and continues to be blue after that. Now, for a point $B$ of distant $k$ to the point $A$, we may run an induction to prove that $B$ will become constantly blue after $k$ seconds. Suppose that this statement has been proved for $k-1$. If $B$ has distant $k$ to $A$, take a square $B'$ adjacent to $B$ that has distant $k-1$ to $A$. By induction, $B'$ is constant blue after $k-1$ seconds, then the same argument as above shows that $B$ is constantly blue after $k$ seconds. From this induction, we deduce that all squares are blue after $2n-2$ seconds.",
          "pages": [
            "P0",
            "P1"
          ],
          "status": "complete"
        }
      ],
      "statement_images": [],
      "statement_latex": "1. On a screen formed by $n \\times n$ ($n \\ge 2$) squares, every square displays initially one of the three colors: red, yellow, and blue. Every second, the screen changes the color of each square following the rules below:\n\n* for each square $A$ whose current color is red, if there is a yellow square sharing a side with this square, then $A$ turns yellow in the next second, otherwise, $A$ remains red;\n* for each square $B$ whose current color is yellow, if there is a blue square sharing a side with this square, then $B$ turns blue in the next second, otherwise, $B$ remains yellow;\n* for each square $C$ whose current color is blue, if there is a red square sharing a side with this square, then $C$ turns red in the next second, otherwise, $C$ remains blue.\n\nProve that if the screen does not change to a single color after $2n - 2$ seconds, then it will never change to a single color."
    },
    {
      "_provenance": {
        "folder": "CHN_2022e",
        "pages_map": {
          "P0": "page15.md",
          "P1": "page16.md",
          "P2": "page17.md"
        }
      },
      "author": null,
      "booklet title": "CHN_TSExams_2022_3.pdf",
      "booklet_url": null,
      "competition name": null,
      "copyright_info": null,
      "has_solutions": true,
      "id": "p_34e9c9d8016d",
      "language": "en",
      "page numbers": [
        0,
        1,
        2
      ],
      "solutions": [
        {
          "images": [
            {
              "alt": "",
              "pages": [
                "P0"
              ],
              "path": "images/CHN_TSExams_2022_3_p4_data_bcf3de2074.png",
              "title": ""
            },
            {
              "alt": "",
              "pages": [
                "P1"
              ],
              "path": "images/CHN_TSExams_2022_3_p5_data_72484e9d18.png",
              "title": ""
            }
          ],
          "label": null,
          "latex": "**Proof 1:** If $AB // CD$ and $AD/BC$, then $ABCD$ is a parallelogram. In this case, $P$ is the midpoint of $AC$ and $AE // CF$. So $PE = PF$.\n\nWe may assume that $AB$ is not parallel to $CD$ from now on. We first show that $AB + AD = CB + CD$. As shown in the following picture, we may assume that the extends of $BA$ and of $CD$ meet at point $T$. Let $\\odot K$ be the excircle of $\\triangle TBC$ in $\\angle B$; meeting the lines $AB, BC, CD$ at $X, Y, Z$, respectively.\n\n% IMAGE: ![](images/CHN_TSExams_2022_3_p4_data_bcf3de2074.png)\n\nSince the internal homothetic center of $\\odot I$ and $\\odot J$ lies on the line $IJ$, and since $AC$ is an inner tangent of the two circles, we deduce that the inner homothetic center of $\\odot I$ and $\\odot J$ is $P$.\n\nIt is well known that the internal homothetic center $P$ of $\\odot I$ and $\\odot J$, the external homothetic center $B$ of $\\odot I$ and $\\odot K$, and the internal homothetic center of $\\odot J$ and $\\odot K$ are colinear. So the internal homothetic center of $\\odot J$ and $\\odot K$ lies on the line $BP$. Since $CD$ is an internal tangent line of $\\odot J$ and $\\odot K$, the internal homothetic center of $\\odot J$ and $\\odot K$ is precisely point $D$. Moreover, $AD$ is tangent to $\\odot K$, say at point $W$.\n\nFrom this, we deduce that\n\n$$\n\\begin{aligned}\nAB + AD &= (BX - AX) + (AW - DW) = BX - DW \\\\\n&= BY - DZ = (CB + CY) - (CZ - CD) = CB + CD.\n\\end{aligned}\n$$\n\nIn other words,\n\n$$\nAB + AD = CB + CD. \\tag{1}\n$$\n\nLet $\\odot U$ and $\\odot V$ denote the excircles of $\\triangle ABD$ in $\\angle ABD$ and in $\\angle ADB$, respectively. Let $\\odot Q$ and $\\odot R$ denote the excircles of $\\triangle BCD$ in $\\angle CBD$ and in $\\angle BDC$, respectively.\n\nNow, we prove that $UR$ and $VQ$ meet at $P$. Consider $\\odot K$, $\\odot U$, and $\\odot R$. It is well known that the external homothetic center $A$ of $\\odot K$ and $\\odot U$, the internal homothetic center $C$ of $\\odot K$ and $\\odot R$, and the internal homothetic center of $\\odot U$ and $\\odot R$ are colinear. Yet $BD$ is the internal tangent line of $\\odot U$ and $\\odot R$; so $P$ is the internal homothetic center of $\\odot U$ and $\\odot R$. It follows that $UR$ passes through $P$. By a similar argument, $VQ$ passes through $P$.\n\n% IMAGE: ![](images/CHN_TSExams_2022_3_p5_data_72484e9d18.png)\n\nNext, we prove that $UQ \\perp BD$ and $VR \\perp BD$. Extend $BD$ to intersect $\\odot U$ and $\\odot Q$ at $L$ and $L'$, respectively. Then\n\n$$\nBL = \\frac{1}{2}(AB + AD + BD), BL' = \\frac{1}{2}(CB + CD + BD).\n$$\n\nCombining this with (1), we deduce that $BL = BL'$, i.e. $L$ and $L'$ coincide. So $UQ \\perp BD$. Similarly, $VR \\perp BD$.\n\nSince $EF \\perp BD$, So $UQ//EF//VR$. Thus,\n\n$$\n\\frac{PE}{UQ} = \\frac{VP}{VQ} = \\frac{RF}{RQ} = \\frac{PF}{UQ},\n$$\n\nSo $PE = PF$. We are done.",
          "pages": [
            "P0",
            "P1",
            "P2"
          ],
          "status": "complete"
        }
      ],
      "statement_images": [
        {
          "alt": "",
          "pages": [
            "P0"
          ],
          "path": "images/CHN_TSExams_2022_3_p4_data_15de662ccd.png",
          "title": ""
        }
      ],
      "statement_latex": "In a convex quadrilateral $ABCD$, let $I$ and $J$ be the incenter of $\\triangle ABC$ and $\\triangle ADC$, respectively. Assume that $IJ, AC, BD$ meet at point $P$. The line through $P$ perpendicular to $BD$ meets the exterior angle bisectors of $\\angle BAD$ at $E$, and meets the exterior angle bisector of $\\angle BCD$ at $F$. Prove that $PE = PF$.\n\n% IMAGE: ![](images/CHN_TSExams_2022_3_p4_data_15de662ccd.png)"
    },
    {
      "_provenance": {
        "folder": "CHN_2022e",
        "pages_map": {
          "P0": "page15.md",
          "P1": "page16.md",
          "P2": "page17.md"
        }
      },
      "author": null,
      "booklet title": "CHN_TSExams_2022_3.pdf",
      "booklet_url": null,
      "competition name": null,
      "copyright_info": null,
      "has_solutions": true,
      "id": "p_8c4e68ff7dd6",
      "language": "en",
      "page numbers": [
        0,
        1
      ],
      "solutions": [
        {
          "images": [],
          "label": null,
          "latex": "Next, we prove that $UQ \\perp BD$ and $VR \\perp BD$. Extend $BD$ to intersect $\\odot U$ and $\\odot Q$ at $L$ and $L'$, respectively. Then\n\n$$\nBL = \\frac{1}{2}(AB + AD + BD), BL' = \\frac{1}{2}(CB + CD + BD).\n$$\n\nCombining this with (1), we deduce that $BL = BL'$, i.e. $L$ and $L'$ coincide. So $UQ \\perp BD$. Similarly, $VR \\perp BD$.\n\nSince $EF \\perp BD$, So $UQ//EF//VR$. Thus,\n\n$$\n\\frac{PE}{UQ} = \\frac{VP}{VQ} = \\frac{RF}{RQ} = \\frac{PF}{UQ},\n$$\n\nSo $PE = PF$. We are done.",
          "pages": [
            "P1"
          ],
          "status": "complete"
        }
      ],
      "statement_images": [
        {
          "alt": "",
          "pages": [
            "P0"
          ],
          "path": "images/CHN_TSExams_2022_3_p5_data_72484e9d18.png",
          "title": null
        }
      ],
      "statement_latex": "Since the internal homothetic center of $\\odot I$ and $\\odot J$ lies on the line $IJ$, and since $AC$ is an inner tangent of the two circles, we deduce that the inner homothetic center of $\\odot I$ and $\\odot J$ is $P$.\n\nIt is well known that the internal homothetic center $P$ of $\\odot I$ and $\\odot J$, the external homothetic center $B$ of $\\odot I$ and $\\odot K$, and the internal homothetic center of $\\odot J$ and $\\odot K$ are colinear. So the internal homothetic center of $\\odot J$ and $\\odot K$ lies on the line $BP$. Since $CD$ is an internal tangent line of $\\odot J$ and $\\odot K$, the internal homothetic center of $\\odot J$ and $\\odot K$ is precisely point $D$. Moreover, $AD$ is tangent to $\\odot K$, say at point $W$.\n\nFrom this, we deduce that\n\n$$\n\\begin{aligned}\nAB + AD &= (BX - AX) + (AW - DW) = BX - DW \\\\\n&= BY - DZ = (CB + CY) - (CZ - CD) = CB + CD.\n\\end{aligned}\n$$\n\nIn other words,\n\n$$\nAB + AD = CB + CD. \\tag{1}\n$$\n\nLet $\\odot U$ and $\\odot V$ denote the excircles of $\\triangle ABD$ in $\\angle ABD$ and in $\\angle ADB$, respectively. Let $\\odot Q$ and $\\odot R$ denote the excircles of $\\triangle BCD$ in $\\angle CBD$ and in $\\angle BDC$, respectively.\n\nNow, we prove that $UR$ and $VQ$ meet at $P$. Consider $\\odot K$, $\\odot U$, and $\\odot R$. It is well known that the external homothetic center $A$ of $\\odot K$ and $\\odot U$, the internal homothetic center $C$ of $\\odot K$ and $\\odot R$, and the internal homothetic center of $\\odot U$ and $\\odot R$ are colinear. Yet $BD$ is the internal tangent line of $\\odot U$ and $\\odot R$; so $P$ is the internal homothetic center of $\\odot U$ and $\\odot R$. It follows that $UR$ passes through $P$. By a similar argument, $VQ$ passes through $P$.\n\n% IMAGE: ![](images/CHN_TSExams_2022_3_p5_data_72484e9d18.png)"
    },
    {
      "_provenance": {
        "folder": "CHN_2022e",
        "pages_map": {
          "P0": "page15.md",
          "P1": "page16.md",
          "P2": "page17.md"
        }
      },
      "author": null,
      "booklet title": "CHN_TSExams_2022_3.pdf",
      "booklet_url": null,
      "competition name": null,
      "copyright_info": null,
      "has_solutions": true,
      "id": "p_17b61724fcd9",
      "language": "en",
      "page numbers": [
        0,
        1,
        2
      ],
      "solutions": [
        {
          "images": [],
          "label": null,
          "latex": "All functions satisfying (*) are $f(x) = x$ and $f(x) = -x$. It is easy to verify that these two functions satisfy (*).\n\nIn what follows, all sets are multisets. Take $x = y = 0$ in (*) gives $\\{f(1), f(-1)\\} = \\{1, -1\\}$. First consider the case when $f(1) = 1$. We want to show that $f(x) = x$ for any $x \\in \\mathbb{R}$.\n\n*Step 1:* Prove that $f(n) = n$ for $n \\in \\mathbb{Z}$.\n\nWe first show that $f(0) = 0$. Take $x = 0$ in (*), we have $\\{f(1), f(yf(0) - 1)\\} = \\{-1, yf(f(0)) + 1\\}$. If $f(0) \\neq 0$, take $y = \\frac{2}{f(0)}$; then the LHS is $\\{1, 1\\}$, which cannot contain the $-1$ on the RHS. So $f(0) = 0$.\n\nNext, we prove inductively $f(n) = n$ for $n \\in \\mathbb{N}$. The case $n = 1$ is known. Assume that $f(m) = m$ holds for $m \\le n$. Take $x = 1$ and $y = n$ in (*), we deduce\n\n\\[\n\\{f(n + 1), f(n - 1)\\} = \\{n - 1, n + 1\\}\n\\]\n\nFrom this, we deduce that $f(n + 1) = n + 1$, completing the inductive proof. Using a similar argument but taking $x = 1$ and $y = -n$ proves that $f(-n) = -n$ for $n \\in \\mathbb{N}$. This completes Step 1.\n\n*Step 2:* Prove that $f$ is a bijection.\n\n$f$ is surjective because when setting $y = 1$ in (*), the RHS contains $xf(f(1)) - 1 = x - 1$, which can take an arbitrary real number. By the form of its LHS, all real numbers are in the image of $f$.\n\nNext, we prove $f(y_0) = 0$ implies $y_0 = 0$. Suppose not, namely $y_0 \\neq 0$. Then taking $y = y_0$ in (*) gives\n\n\\[\n\\{f(1), f(y_0f(x) - 1)\\} = \\{-1, y_0f(f(x)) + 1\\}.\n\\]\n\nWe must have $1 = f(1) = y_0f(f(x)) + 1$. So $f(f(x)) = 0$ holds for all $x$. This contradicts with $f(1) = 1$.\n\nWe next prove the injectivity of $f$. If $y_1 \\neq y_2$ satisfy $f(y_1) = f(y_2) \\neq 0$. Taking respectively $y = y_1$ and $y = y_2$ in (*) gives\n\n\\[\n\\{f(xf(y_1) + 1), f(y_1f(x) - 1)\\} = \\{xf(f(y_1)) - 1, y_1f(f(x)) + 1\\},\n\\]\n\n\\[\n\\{f(xf(y_2) + 1), f(y_2f(x) - 1)\\} = \\{xf(f(y_2)) - 1, y_2f(f(x)) + 1\\}.\n\\]\n\nNote that the first elements on both sides of the two equations are the same, respectively.\n\nIf some $x_0 \\in \\mathbb{R}$ satisfies $f(x_0f(y_1) + 1) \\neq x_0f(f(y_1)) - 1$, then\n\n\\[\ny_1f(f(x_0)) + 1 = f(xf(y_1) + 1) = f(xf(y_2) + 1) = y_2f(f(x_0)) + 1\n\\]\n\nFrom this, we get $y_1f(f(x_0)) = y_2f(f(x_0))$, thus $f(f(x_0)) = 0$, which implies $x_0 = 0$.\n\nSo if $x \\neq 0$, then $f(xf(y_1) + 1) = xf(f(y_1)) - 1$. From this, we deduce that $f(x) = ax + b$ for some $a, b \\in \\mathbb{R}$ and any $x \\neq 1$ is a linear function. But $f(n) = n$ for $n \\in \\mathbb{Z}$ implies that $a = 1$ and $b = 0$. So $f(x) = x$ is injective.\n\n**Step 3:** Prove that for any $n \\in \\mathbb{Z}$ and $y \\in \\mathbb{R}$, we have\n\n\\[\nf\\left(f\\left(\\frac{n}{f(y)}\\right)\\right) = \\frac{n}{y} \\qquad (1)\n\\]\n\nIt is enough to consider the case when $n \\neq 0$ and $y \\neq 0$. Taking $x = \\frac{n}{f(y)}$ in $(*)$ gives\n\n\\[\n\\left\\{n + 1, f\\left(yf\\left(\\frac{n}{f(y)}\\right) - 1\\right)\\right\\} = \\left\\{n\\frac{f(f(y))}{f(y)} - 1, yf\\left(f\\left(\\frac{n}{f(y)}\\right)\\right) + 1\\right\\}. \\quad (2)\n\\]\n\nSimilarly, substituting $y$ for $x$ and $\\frac{n}{f(y)}$ for $y$ in $(*)$ gives\n\n\\[\n\\left\\{n - 1, f\\left(yf\\left(\\frac{n}{f(y)}\\right) + 1\\right)\\right\\} = \\left\\{n\\frac{f(f(y))}{f(y)} + 1, yf\\left(f\\left(\\frac{n}{f(y)}\\right)\\right) - 1\\right\\}. \\quad (3)\n\\]\n\nIf there exists some $y_0 \\in \\mathbb{R} \\setminus \\{0\\}$ such that $n \\neq y_0f\\left(f\\left(\\frac{n}{f(y_0)}\\right)\\right)$, then combining (2) and (3) gives\n\n\\[\nn + 1 = n \\frac{f(f(y_0))}{f(y_0)} - 1, \\quad n - 1 = n \\frac{f(f(y_0))}{f(y_0)} + 1.\n\\]\n\nTaking the differences of the two equations gives $2 = -2$, which is a contradiction.\n\n**Step 4:** For $\\alpha \\in \\mathbb{Q}$ and $y \\in \\mathbb{R}$, prove that $f(\\alpha y) = \\alpha f(y)$.\n\nWe may assume that $\\alpha \\neq 0$ and $y \\neq 0$. Substituting $f\\left(\\frac{m}{f(y)}\\right)$ with $m \\in \\mathbb{Z} \\setminus \\{0\\}$ for $y$ in (1) gives\n\n\\[\nf\\left(f\\left(\\frac{n}{f\\left(f\\left(\\frac{m}{f(y)}\\right)\\right)}\\right)\\right) = \\frac{n}{f\\left(\\frac{m}{f(y)}\\right)}.\n\\]\n\nPlugging (1) into the denominator of the LHS gives\n\n\\[\nf\\left(f\\left(\\frac{n}{m}y\\right)\\right) = \\frac{n}{f\\left(\\frac{m}{f(y)}\\right)}.\n\\]\n\nIn the above equality, substituting $\\frac{t}{f(y)}$ with $t \\in \\mathbb{Z} \\setminus \\{0\\}$ for $y$ gives\n\n\\[\n\\frac{nt/m}{y} = f\\left(f\\left(\\frac{n}{m}\\frac{t}{f(y)}\\right)\\right) = \\frac{n}{f\\left(\\frac{m}{f\\left(\\frac{t}{f(y)}\\right)}\\right)}.\n\\]\n\nThis is equivalent to $f(\\frac{m}{f(\\frac{t}{f(y)})}) = \\frac{m}{t}y$. Taking $f$ on both sides gives\n\n\\[\n\\frac{m}{t} f(y) = f\\left(f\\left(\\frac{m}{f(\\frac{t}{f(y)})}\\right)\\right) = f\\left(\\frac{m}{t}y\\right).\n\\]\n\nThis completes Step 4.\n\n**Step 5:** Prove that $f(y+a) = f(y) + a$ for all $y \\in \\mathbb{R}$ and $a \\in \\mathbb{Q}$.\n\nTaking $x = \\frac{1}{r} \\in \\mathbb{Q} \\setminus \\{0\\}$ in (*) gives\n\n\\[\n\\{f(\\frac{1}{r}f(y) + 1), f(\\frac{1}{r}y - 1)\\} = \\{\\frac{1}{r}f(f(y)) - 1, \\frac{1}{r}y + 1\\}.\n\\]\n\nUsing Step 4 and multiplying both sides by $r$ gives\n\n\\[\n\\{f(f(y) + r), f(y - r)\\} = \\{f(f(y)) - r, y + r\\}. \\quad (4)\n\\]\n\nWe want to prove that $f(y-r) = f(f(y)) - r$. Suppose that there exist some $y_0 \\in \\mathbb{R}$ and $r_0 \\in \\mathbb{R} \\setminus \\{0\\}$ such that $f(y_0 - r_0) = y_0 + r_0$. Taking $y = y_0 - r_0$ and $r = -2r_0$ in (4) gives\n\n\\[\n\\{f(f(y_0 - r_0) - 2r_0), f(y_0 - r_0 + 2r_0)\\} = \\{f(f(y_0 - r_0)) + 2r_0, y_0 - 3r_0\\}.\n\\]\n\nThis is the same as\n\n\\[\n\\{y_0 + r_0, f(y_0 + r_0)\\} = \\{f(y_0 + r_0) + 2r_0, y_0 - 3r_0\\}.\n\\]\n\nSince $y_0 + r_0 \\neq y_0 - 3r_0$, we must have $y_0 + r_0 = f(y_0 + r_0) + 2r_0$, i.e. $f(y_0 + r_0) = y_0 - r_0$. But then the two sides of the equality becomes $\\{y_0 + r_0, y_0 - r_0\\} = \\{y_0 + r_0, y_0 - 3r_0\\}$. They are obviously not equal, giving a contradiction.\n\nSo $f(y - r) = f(f(y)) - r$ must hold for all $y \\in \\mathbb{R}$ and $r \\in \\mathbb{Q} \\setminus \\{0\\}$. Taking two different values of $r$ and taking the difference gives $f(y + a) = f(y) + a$ for all $y \\in \\mathbb{R}$ and $a \\in \\mathbb{Q}$.\n\n**Step 6:** Prove that $f(y) = y$ for $y \\in \\mathbb{R}$.\n\nCombining Step 5 and (4) gives\n\n\\[\n\\{f(f(y)) + r, f(y) - r\\} = \\{f(f(y)) - r, y + r\\}.\n\\]\n\nTaking the sum of the two elements on both sides of the equality, we deduce that $f(f(y)) + f(y) = f(f(y)) + y$, i.e. $f(y) = y$.\n\nNow we consider the case when $f(1) = -1$. We aim to prove that $f(x) = -x$ ($x \\in \\mathbb{R}$).\n\n**Step 1:** Prove that $f(n) = -n$ ($n \\in \\mathbb{Z}$).",
          "pages": [
            "P0",
            "P1",
            "P2"
          ],
          "status": "truncated"
        }
      ],
      "statement_images": [],
      "statement_latex": "Find all functions $f : \\mathbb{R} \\to \\mathbb{R}$ such that, for any real numbers $x, y$, the following two multisets are equal\n\n\\[\n\\{f(xf(y) + 1), f(yf(x) - 1)\\} = \\{xf(f(y)) - 1, yf(f(x)) + 1\\}. \\quad (*)\n\\]\n\n*Remark: {a, b} = {c, d} are equal as multisets if a = c and b = d, or a = d and b = c.*"
    },
    {
      "_provenance": {
        "folder": "CHN_2022e",
        "pages_map": {
          "P0": "page15.md",
          "P1": "page16.md",
          "P2": "page17.md"
        }
      },
      "author": null,
      "booklet title": "CHN_TSExams_2022_3.pdf",
      "booklet_url": null,
      "competition name": null,
      "copyright_info": null,
      "has_solutions": true,
      "id": "p_f40b5434e24e",
      "language": "en",
      "page numbers": [
        0,
        1,
        2
      ],
      "solutions": [
        {
          "images": [],
          "label": null,
          "latex": "This is equivalent to $f(\\frac{m}{f(\\frac{t}{f(y)})}) = \\frac{m}{t}y$. Taking $f$ on both sides gives\n\n$$\n\\frac{m}{t} f(y) = f\\left(f\\left(\\frac{m}{f(\\frac{t}{f(y)})}\\right)\\right) = f\\left(\\frac{m}{t}y\\right).\n$$\n\nThis completes Step 4.\n\n**Step 5:** Prove that $f(y+a) = f(y) + a$ for all $y \\in \\mathbb{R}$ and $a \\in \\mathbb{Q}$.\n\nTaking $x = \\frac{1}{r} \\in \\mathbb{Q} \\setminus \\{0\\}$ in (*) gives\n\n$$\n\\{f(\\frac{1}{r}f(y) + 1), f(\\frac{1}{r}y - 1)\\} = \\{\\frac{1}{r}f(f(y)) - 1, \\frac{1}{r}y + 1\\}.\n$$\n\nUsing Step 4 and multiplying both sides by $r$ gives\n\n$$\n\\{f(f(y) + r), f(y - r)\\} = \\{f(f(y)) - r, y + r\\}. \\quad (4)\n$$\n\nWe want to prove that $f(y-r) = f(f(y)) - r$. Suppose that there exist some $y_0 \\in \\mathbb{R}$ and $r_0 \\in \\mathbb{R} \\setminus \\{0\\}$ such that $f(y_0 - r_0) = y_0 + r_0$. Taking $y = y_0 - r_0$ and $r = -2r_0$ in (4) gives\n\n$$\n\\{f(f(y_0 - r_0) - 2r_0), f(y_0 - r_0 + 2r_0)\\} = \\{f(f(y_0 - r_0)) + 2r_0, y_0 - 3r_0\\}.\n$$\n\nThis is the same as\n\n$$\n\\{y_0 + r_0, f(y_0 + r_0)\\} = \\{f(y_0 + r_0) + 2r_0, y_0 - 3r_0\\}.\n$$\n\nSince $y_0 + r_0 \\neq y_0 - 3r_0$, we must have $y_0 + r_0 = f(y_0 + r_0) + 2r_0$, i.e. $f(y_0 + r_0) = y_0 - r_0$. But then the two sides of the equality becomes $\\{y_0 + r_0, y_0 - r_0\\} = \\{y_0 + r_0, y_0 - 3r_0\\}$. They are obviously not equal, giving a contradiction.\n\nSo $f(y - r) = f(f(y)) - r$ must hold for all $y \\in \\mathbb{R}$ and $r \\in \\mathbb{Q} \\setminus \\{0\\}$. Taking two different values of $r$ and taking the difference gives $f(y + a) = f(y) + a$ for all $y \\in \\mathbb{R}$ and $a \\in \\mathbb{Q}$.\n\n**Step 6:** Prove that $f(y) = y$ for $y \\in \\mathbb{R}$.\n\nCombining Step 5 and (4) gives\n\n$$\n\\{f(f(y)) + r, f(y) - r\\} = \\{f(f(y)) - r, y + r\\}.\n$$\n\nTaking the sum of the two elements on both sides of the equality, we deduce that $f(f(y)) + f(y) = f(f(y)) + y$, i.e. $f(y) = y$.\n\nNow we consider the case when $f(1) = -1$. We aim to prove that $f(x) = -x$ ($x \\in \\mathbb{R}$).\n\n**Step 1:** Prove that $f(n) = -n$ ($n \\in \\mathbb{Z}$).\n\nTaking $y = 1$ and respectively $x = 1, -1$ in (*) gives\n\n$$\n\\{f(0), f(-2)\\} = \\{0, 2\\}, \\quad \\{f(2), f(0)\\} = \\{-2, 0\\}.\n$$\n\nFrom this, we deduce that $f(0) = 0$, $f(2) = -2$, $f(-2) = 2$.\n\nNext, we inductively prove that $f(n) = -n$. When $|n| = 1, 2$, this is already proved. Suppose that we have proved this when $|n| \\le n_0$ ($n_0 \\ge 2$). Taking $y = 1$ and $x = n_0, -n_0$ in (*) gives\n\n$$\n\\begin{aligned} \\{f(-n_0 + 1), f(f(n_0) - 1)\\} &= \\{n_0 - 1, f(f(n_0)) + 1\\}, \\\\ \\{f(n_0 + 1), f(f(-n_0) - 1)\\} &= \\{-n_0 - 1, f(f(-n_0)) + 1\\} \\end{aligned}\n$$\n\nWe deduce from this that $f(n_0 + 1) = -n_0 - 1$ and $f(-n_0 - 1) = n_0 + 1$. This completes the induction in Step 1.\n\n**Step 2:** Prove that $f(x) = -x$ holds for all $x \\in \\mathbb{R}$.\n\nFirst, as in the $f(1) = 1$ case, we can prove that $f$ is surjective.\n\nFor a nonzero integer $n$ and $z \\in \\mathbb{R}\\{0\\}$, taking $x = \\frac{n}{f(z)}$, $y = z$, and taking $x = z$, $y = \\frac{n}{f(z)}$ in (*), we obtain\n\n$$\n\\begin{aligned} \\{-n-1, f\\left(zf\\left(\\frac{n}{f(z)}\\right) - 1\\right)\\} &= \\{n\\frac{f(f(z))}{f(z)} - 1, zf\\left(f\\left(\\frac{n}{f(z)}\\right)\\right) + 1\\}, & (5) \\\\ \\{-n+1, f\\left(zf\\left(\\frac{n}{f(z)}\\right) + 1\\right)\\} &= \\{n\\frac{f(f(z))}{f(z)} + 1, zf\\left(f\\left(\\frac{n}{f(z)}\\right)\\right) - 1\\} \\end{aligned}\n$$\n\nIf for some $z = z_0 \\in \\mathbb{R}\\{0\\}$ we have $f(f(z_0)) \\ne f(z_0)$, then by (5), we deduce that\n\n$$\n-n-1 = zf\\left(f\\left(\\frac{n}{f(z)}\\right)\\right) + 1, \\quad -n+1 = zf\\left(f\\left(\\frac{n}{f(z)}\\right)\\right) - 1.\n$$\n\nTaking the difference of the two equalities gives $2 = -2$. This is a contradiction!\n\nSo $f(f(z_0)) = -f(z_0)$. But $f$ is surjective. So $f(x) = -x$ holds for all $x \\in \\mathbb{R}\\{0\\}$. Moreover, $f(0) = 0$ is known. This completes the proof of $f(x) = -x$ when $f(1) = -1$.\n\nCombining the above two cases, the needed functions are $f(x) = x$ ($x \\in \\mathbb{R}$) and $f(x) = -x$ ($x \\in \\mathbb{R}$).\n",
          "pages": [
            "P1",
            "P2"
          ],
          "status": "complete"
        }
      ],
      "statement_images": [],
      "statement_latex": "Note that the first elements on both sides of the two equations are the same, respectively.\n\nIf some $x_0 \\in \\mathbb{R}$ satisfies $f(x_0f(y_1) + 1) \\neq x_0f(f(y_1)) - 1$, then\n\n$$\ny_1f(f(x_0)) + 1 = f(xf(y_1) + 1) = f(xf(y_2) + 1) = y_2f(f(x_0)) + 1\n$$\n\nFrom this, we get $y_1f(f(x_0)) = y_2f(f(x_0))$, thus $f(f(x_0)) = 0$, which implies $x_0 = 0$.\n\nSo if $x \\neq 0$, then $f(xf(y_1) + 1) = xf(f(y_1)) - 1$. From this, we deduce that $f(x) = ax + b$ for some $a, b \\in \\mathbb{R}$ and any $x \\neq 1$ is a linear function. But $f(n) = n$ for $n \\in \\mathbb{Z}$ implies that $a = 1$ and $b = 0$. So $f(x) = x$ is injective.\n\n**Step 3:** Prove that for any $n \\in \\mathbb{Z}$ and $y \\in \\mathbb{R}$, we have\n\n$$\nf\\left(f\\left(\\frac{n}{f(y)}\\right)\\right) = \\frac{n}{y} \\qquad (1)\n$$\n\nIt is enough to consider the case when $n \\neq 0$ and $y \\neq 0$. Taking $x = \\frac{n}{f(y)}$ in $(*)$ gives\n\n$$\n\\left\\{n + 1, f\\left(yf\\left(\\frac{n}{f(y)}\\right) - 1\\right)\\right\\} = \\left\\{n\\frac{f(f(y))}{f(y)} - 1, yf\\left(f\\left(\\frac{n}{f(y)}\\right)\\right) + 1\\right\\}. \\quad (2)\n$$\n\nSimilarly, substituting $y$ for $x$ and $\\frac{n}{f(y)}$ for $y$ in $(*)$ gives\n\n$$\n\\left\\{n - 1, f\\left(yf\\left(\\frac{n}{f(y)}\\right) + 1\\right)\\right\\} = \\left\\{n\\frac{f(f(y))}{f(y)} + 1, yf\\left(f\\left(\\frac{n}{f(y)}\\right)\\right) - 1\\right\\}. \\quad (3)\n$$\n\nIf there exists some $y_0 \\in \\mathbb{R} \\setminus \\{0\\}$ such that $n \\neq y_0f\\left(f\\left(\\frac{n}{f(y_0)}\\right)\\right)$, then combining (2) and (3) gives\n\n$$\nn + 1 = n \\frac{f(f(y_0))}{f(y_0)} - 1, \\quad n - 1 = n \\frac{f(f(y_0))}{f(y_0)} + 1.\n$$\n\nTaking the differences of the two equations gives $2 = -2$, which is a contradiction.\n\n**Step 4:** For $\\alpha \\in \\mathbb{Q}$ and $y \\in \\mathbb{R}$, prove that $f(\\alpha y) = \\alpha f(y)$.\n\nWe may assume that $\\alpha \\neq 0$ and $y \\neq 0$. Substituting $f\\left(\\frac{m}{f(y)}\\right)$ with $m \\in \\mathbb{Z} \\setminus \\{0\\}$ for $y$ in (1) gives\n\n$$\nf\\left(f\\left(\\frac{n}{f\\left(f\\left(\\frac{m}{f(y)}\\right)\\right)}\\right)\\right) = \\frac{n}{f\\left(\\frac{m}{f(y)}\\right)}.\n$$\n\nPlugging (1) into the denominator of the LHS gives\n\n$$\nf\\left(f\\left(\\frac{n}{m}y\\right)\\right) = \\frac{n}{f\\left(\\frac{m}{f(y)}\\right)}.\n$$\n\nIn the above equality, substituting $\\frac{t}{f(y)}$ with $t \\in \\mathbb{Z} \\setminus \\{0\\}$ for $y$ gives\n\n$$\n\\frac{nt/m}{y} = f\\left(f\\left(\\frac{n}{m}\\frac{t}{f(y)}\\right)\\right) = \\frac{n}{f\\left(\\frac{m}{f\\left(\\frac{t}{f(y)}\\right)}\\right)}.\n$$"
    },
    {
      "_provenance": {
        "folder": "CHN_2022e",
        "pages_map": {
          "P0": "page15.md",
          "P1": "page16.md",
          "P2": "page17.md"
        }
      },
      "author": null,
      "booklet title": "CHN_TSExams_2022_3.pdf",
      "booklet_url": null,
      "competition name": null,
      "copyright_info": null,
      "has_solutions": true,
      "id": "p_3cf8c34e47cd",
      "language": "en",
      "page numbers": [
        0,
        1
      ],
      "solutions": [
        {
          "images": [],
          "label": null,
          "latex": "Taking $y = 1$ and respectively $x = 1, -1$ in (*) gives\n\n$$\n\\{f(0), f(-2)\\} = \\{0, 2\\}, \\quad \\{f(2), f(0)\\} = \\{-2, 0\\}.\n$$\n\nFrom this, we deduce that $f(0) = 0$, $f(2) = -2$, $f(-2) = 2$.\n\nNext, we inductively prove that $f(n) = -n$. When $|n| = 1, 2$, this is already proved. Suppose that we have proved this when $|n| \\le n_0$ ($n_0 \\ge 2$). Taking $y = 1$ and $x = n_0, -n_0$ in (*) gives\n\n$$\n\\begin{aligned} \\{f(-n_0 + 1), f(f(n_0) - 1)\\} &= \\{n_0 - 1, f(f(n_0)) + 1\\}, \\\\ \\{f(n_0 + 1), f(f(-n_0) - 1)\\} &= \\{-n_0 - 1, f(f(-n_0)) + 1\\} \\end{aligned}\n$$\n\nWe deduce from this that $f(n_0 + 1) = -n_0 - 1$ and $f(-n_0 - 1) = n_0 + 1$. This completes the induction in Step 1.\n\n**Step 2:** Prove that $f(x) = -x$ holds for all $x \\in \\mathbb{R}$.\n\nFirst, as in the $f(1) = 1$ case, we can prove that $f$ is surjective.\n\nFor a nonzero integer $n$ and $z \\in \\mathbb{R}\\{0\\}$, taking $x = \\frac{n}{f(z)}$, $y = z$, and taking $x = z$, $y = \\frac{n}{f(z)}$ in (*), we obtain\n\n$$\n\\begin{aligned} \\{-n-1, f\\left(zf\\left(\\frac{n}{f(z)}\\right) - 1\\right)\\} &= \\{n\\frac{f(f(z))}{f(z)} - 1, zf\\left(f\\left(\\frac{n}{f(z)}\\right)\\right) + 1\\}, & (5) \\\\ \\{-n+1, f\\left(zf\\left(\\frac{n}{f(z)}\\right) + 1\\right)\\} &= \\{n\\frac{f(f(z))}{f(z)} + 1, zf\\left(f\\left(\\frac{n}{f(z)}\\right)\\right) - 1\\}. \\end{aligned}\n$$\n\nIf for some $z = z_0 \\in \\mathbb{R}\\{0\\}$ we have $f(f(z_0)) \\ne f(z_0)$, then by (5), we deduce that\n\n$$\n-n-1 = zf\\left(f\\left(\\frac{n}{f(z)}\\right)\\right) + 1, \\quad -n+1 = zf\\left(f\\left(\\frac{n}{f(z)}\\right)\\right) - 1.\n$$\n\nTaking the difference of the two equalities gives $2 = -2$. This is a contradiction!\n\nSo $f(f(z_0)) = -f(z_0)$. But $f$ is surjective. So $f(x) = -x$ holds for all $x \\in \\mathbb{R}\\{0\\}$. Moreover, $f(0) = 0$ is known. This completes the proof of $f(x) = -x$ when $f(1) = -1$.\n\nCombining the above two cases, the needed functions are $f(x) = x$ ($x \\in \\mathbb{R}$) and $f(x) = -x$ ($x \\in \\mathbb{R}$).",
          "pages": [
            "P1"
          ],
          "status": "complete"
        }
      ],
      "statement_images": [],
      "statement_latex": "This is equivalent to $f(\\frac{m}{f(\\frac{t}{f(y)})}) = \\frac{m}{t}y$. Taking $f$ on both sides gives\n\n$$\n\\frac{m}{t} f(y) = f\\left(f\\left(\\frac{m}{f(\\frac{t}{f(y)})}\\right)\\right) = f\\left(\\frac{m}{t}y\\right).\n$$\n\nThis completes Step 4.\n\n**Step 5:** Prove that $f(y+a) = f(y) + a$ for all $y \\in \\mathbb{R}$ and $a \\in \\mathbb{Q}$.\n\nTaking $x = \\frac{1}{r} \\in \\mathbb{Q} \\setminus \\{0\\}$ in (*) gives\n\n$$\n\\{f(\\frac{1}{r}f(y) + 1), f(\\frac{1}{r}y - 1)\\} = \\{\\frac{1}{r}f(f(y)) - 1, \\frac{1}{r}y + 1\\}.\n$$\n\nUsing Step 4 and multiplying both sides by $r$ gives\n\n$$\n\\{f(f(y) + r), f(y - r)\\} = \\{f(f(y)) - r, y + r\\}. \\quad (4)\n$$\n\nWe want to prove that $f(y-r) = f(f(y)) - r$. Suppose that there exist some $y_0 \\in \\mathbb{R}$ and $r_0 \\in \\mathbb{R} \\setminus \\{0\\}$ such that $f(y_0 - r_0) = y_0 + r_0$. Taking $y = y_0 - r_0$ and $r = -2r_0$ in (4) gives\n\n$$\n\\{f(f(y_0 - r_0) - 2r_0), f(y_0 - r_0 + 2r_0)\\} = \\{f(f(y_0 - r_0)) + 2r_0, y_0 - 3r_0\\}.\n$$\n\nThis is the same as\n\n$$\n\\{y_0 + r_0, f(y_0 + r_0)\\} = \\{f(y_0 + r_0) + 2r_0, y_0 - 3r_0\\}.\n$$\n\nSince $y_0 + r_0 \\neq y_0 - 3r_0$, we must have $y_0 + r_0 = f(y_0 + r_0) + 2r_0$, i.e. $f(y_0 + r_0) = y_0 - r_0$. But then the two sides of the equality becomes $\\{y_0 + r_0, y_0 - r_0\\} = \\{y_0 + r_0, y_0 - 3r_0\\}$. They are obviously not equal, giving a contradiction.\n\nSo $f(y - r) = f(f(y)) - r$ must hold for all $y \\in \\mathbb{R}$ and $r \\in \\mathbb{Q} \\setminus \\{0\\}$. Taking two different values of $r$ and taking the difference gives $f(y + a) = f(y) + a$ for all $y \\in \\mathbb{R}$ and $a \\in \\mathbb{Q}$.\n\n**Step 6:** Prove that $f(y) = y$ for $y \\in \\mathbb{R}$.\n\nCombining Step 5 and (4) gives\n\n$$\n\\{f(f(y)) + r, f(y) - r\\} = \\{f(f(y)) - r, y + r\\}.\n$$\n\nTaking the sum of the two elements on both sides of the equality, we deduce that $f(f(y)) + f(y) = f(f(y)) + y$, i.e. $f(y) = y$.\n\nNow we consider the case when $f(1) = -1$. We aim to prove that $f(x) = -x$ ($x \\in \\mathbb{R}$).\n\n**Step 1:** Prove that $f(n) = -n$ ($n \\in \\mathbb{Z}$)."
    },
    {
      "_provenance": {
        "folder": "CHN_2022e",
        "pages_map": {
          "P0": "page15.md",
          "P1": "page16.md",
          "P2": "page17.md"
        }
      },
      "author": null,
      "booklet title": "CHN_TSExams_2022_3.pdf",
      "booklet_url": null,
      "competition name": null,
      "copyright_info": null,
      "has_solutions": true,
      "id": "p_6e91de958484",
      "language": "en",
      "page numbers": [
        0,
        1
      ],
      "solutions": [
        {
          "images": [],
          "label": null,
          "latex": "Obviously, $p$ is odd, so $p \\ge 3$. If $c = 1$, then\n\n$$\np + 3 = 2^a p^b \\ge 2p \\ge p + 3,\n$$\n\nThis can only happen when $p = 3$, $a = b = 1$, giving one solution $(p, a, b, c) = (3, 1, 1, 1)$. In what follows, we assume that $c \\ge 2$.\n\nCase 1: $c$ is odd. Assume that $q$ is a prime factor of $c$. Since $(p+2)^q+1 \\mid (p+2)^c+1$,\n\n$$\n(p + 2)^q + 1 = 2^\\alpha p^\\beta. \\qquad (1)\n$$\n\nObviously, $\\alpha > 0$. Note that $(p+2)^q + 1 = (p+3)A$, where\n\n$$\nA = (p+2)^{q-1} - (p+2)^{q-2} + \\cdots + 1 > (p+2)^{q-1} - (p+2)^{q-2} = (p+2)^{q-2}(p+1) > p^{q-1},\n$$\n\nand $A$ is odd, so $A$ is a power of $p$. So $A \\ge p^q$ and $\\beta \\ge q$. Taking both sides of (1) modulo $p$ gives $2^q \\equiv -1 \\pmod p$, so the order of $2 \\pmod p$ is 2 or $2q$.\n\nIf the order of $2 \\pmod p$ is 2, then $p = 3$. In this case, $(1)$ is $5^q + 1 = 2^\\alpha 3^\\beta$. Since $5^q + 1 \\equiv 2 \\pmod 4$, we have $\\alpha = 1$. By Lifting-the-exponent Lemma, $v_3(5^q + 1) = v_3(5+1) + v_3(q) \\le 2$, so $\\beta \\le 2$. One checks that $\\beta = 1, 2$ does not satisfy the equation.\n\nIf the order of $2 \\pmod p$ is $2q$, then $2q \\mid p-1$. So $q \\le \\frac{p-1}{2} < \\frac{p}{2}$. Dividing both sides of (1) by $p^q$ and using $(1+\\frac{1}{x})^x < e$, $x \\ge 1$, we have\n\n$$\n2^\\alpha p^{\\beta-q} = \\left(1 + \\frac{2}{p}\\right)^q + p^{-q} < \\left(1 + \\frac{2}{p}\\right)^{\\frac{p}{2}} + p^{-q} < e + 3^{-3} < 3.\n$$\n\nSo $\\beta = q$ and $\\alpha = 1$. Using $2 \\cdot p^q = (p+2)^q + 1 = (p+3)A$, we get $A = p^q$ and $p+3=2$. This is a contradiction.\n\nCase 2: $c$ is even. Assume that $2^d \\nmid c$ with $d \\ge 1$. Then $(p+2)^{2d} + 1 \\mid (p+2)^c + 1$. So\n\n$$\n(p + 2)^{2d} + 1 = 2^\\alpha p^\\beta.\n$$\n\nSince $(p+2)^{2d} + 1 \\equiv 2 \\pmod 4$, $\\alpha = 1$.\n\n$$\n(p + 2)^{2d} + 1 = 2 \\cdot p^{\\beta}. \\qquad (2)\n$$\n\nTaking both sides of (2) modulo $p$ gives $2^{2d} \\equiv -1 \\pmod p$. So the order of $2 \\pmod p$ is $2^{d+1}$. Thus, $2^d < \\frac{p}{2}$. Since\n\n$$\np^{\\beta+1} > 2 \\cdot p^{\\beta} = (p+2)^{2d} + 1 > p^{2d},\n$$\n\nwe have $\\beta \\ge 2^d$. Dividing both sides of (2) by $p^{2^d}$, we have\n\n$$\n2 \\cdot p^{\\beta-2^d} = \\left(1 + \\frac{2}{p}\\right)^{2^d} + p^{-2^d} < \\left(1 + \\frac{2}{p}\\right)^{\\frac{p}{2}} + p^{-2^d} < e + 3^{-2} < 3,\n$$\n\nso $\\beta = 2^d$.\n\nIf $d \\ge 2$, then $2^{d+1} \\mid p-1$ implies that $p \\equiv 1 \\pmod 8$. Using (2), we have $p^{2^d} - 1 = (p+2)^{2^d} - p^{2^d}$. Analyzing the number of factors 2 on both sides of the equality, we deduce that\n\n$$\nv_2(p^{2^d} - 1) = v_2(p^2 - 1) + d - 1 \\ge d + 3.\n$$\n\nYet,\n\n$$\nv_2((p+2)^{2^d} - p^{2^d}) = v_2((p+2)^2 - p^2) + d - 1 = v_2(2) + v_2(2p+2) + d - 1 = d + 2,\n$$\n\ngiving a contradiction. So $d=1$ and $2p^2 = (p+2)^2 + 1$, which implies that $p=5$. Going back to the original equation, we have $c = 2k$, with $k$ odd. But $a=1$, so we have\n\n$$\n2 \\cdot 5^b = 7^{2k} + 1.\n$$\n\nUsing Lifting-the-exponent Lemma again, we have $b = v_5(7^{2k} + 1) = v_5(7^2 + 1) + v_5(k) \\le 2 + \\frac{k}{5}$. If $k \\ge 3$, then\n\n$$\n2 \\cdot 5^b \\le 2 \\cdot 5^{2+\\frac{k}{5}} = (7^2 + 1) \\cdot 5^{\\frac{k}{5}} < 7^{2k} + 1,\n$$\n\ngiving a contradiction. So $k=1$, and thus $c=2$ and $b=2$. This gives another solution $(p, a, b, c) = (5, 1, 2, 2)$.\n\nTo sum up, there are two solutions of $(p, a, b, c)$: $(3, 1, 1, 1)$ and $(5, 1, 2, 2)$.",
          "pages": [
            "P0",
            "P1"
          ],
          "status": "complete"
        }
      ],
      "statement_images": [],
      "statement_latex": "Find all prime numbers $p$ and positive integers $a, b, c$ such that\n\n$$\n2^a p^b = (p + 2)^c + 1.\n$$"
    },
    {
      "_provenance": {
        "folder": "CHN_2022e",
        "pages_map": {
          "P0": "page15.md",
          "P1": "page16.md",
          "P2": "page17.md"
        }
      },
      "author": null,
      "booklet title": "CHN_TSExams_2022_3.pdf",
      "booklet_url": null,
      "competition name": null,
      "copyright_info": null,
      "has_solutions": true,
      "id": "p_bfbd7b7c4264",
      "language": "en",
      "page numbers": [
        0
      ],
      "solutions": [
        {
          "images": [],
          "label": null,
          "latex": "Set $A = x_1 + x_3 + \\dots + x_{2n-1}$ and $B = x_2 + x_4 + \\dots + x_{2n}$.\n\nIf one of $A, B$ is less than or equal to 1, the problem is obvious. If $A > 1$ and $B > 1$, for $0 \\le k \\le n-1$, let $m(k) \\in \\{1, 2, \\dots, n-1\\}$ be the unique integer such that\n\n$$\n\\sum_{i=0}^{m(k)} x_{2k+2i+1} > 1 \\quad (1)\n$$\n\n$$\n\\sum_{i=0}^{m(k)-1} x_{2k+2i+1} \\le 1. \\quad (2)\n$$\n\nNote that, if $x_{2k+2m(k)+2} + x_{2k+2m(k)+4} + \\dots + x_{2k+2n-2} \\le 1$, then this equation and (2) gives what we needed with $p = 2k$ and $q = m(k)$.\n\nNow suppose that\n\n$$\nx_{2k+2m(k)+2} + x_{2k+2m(k)+4} + \\dots + x_{2k+2n-2} > 1. \\quad (3)\n$$\n\nNow, we construct an oriented graph with $0, 1, 2, \\dots, n-1$ as vertices, and connect an edge from each $k$ to $k+m(k)+1$ (with indices modulo $n$). It is easy to see that there are loops in this graph. We may assume that $k_1 \\to k_2 \\to \\dots \\to k_t \\to k_1$ is a minimal loop.\n\nIf $t=1$, then $\\sum_{i=0}^{n-2} x_{2k_1+2i+1} \\le 1$. Setting $p=2k_1$ and $q=n-1$ gives what we want.\nIf $t>1$, then set\n\n$$\n\\left\\{ \\frac{k_2 - k_1}{n} \\right\\} + \\left\\{ \\frac{k_3 - k_2}{n} \\right\\} + \\dots + \\left\\{ \\frac{k_t - k_{t-1}}{n} \\right\\} + \\left\\{ \\frac{k_1 - k_t}{n} \\right\\} = s.\n$$\n\nIn other words, when $k = k_1, k_2, \\dots, k_t$, there are totally $s \\cdot n$ elements in the sums of (1). Moreover, using the condition for defining the edges, we know that every term in $x_1, x_3, \\dots, x_{2n-1}$ appeared in the sum (1) exactly $s$ times. On the other hand, when $k = k_1, k_2, \\dots, k_t$, there are in total $(t-s) \\cdot n$ elements in the sums in (3). The condition for linking an edge shows that each of $x_2, x_4, \\dots, x_{2n}$ appeared exactly $t-s$ times in the above sum; this is because $x_{2j}$ appeared in (3) if and only if $x_{2j+1}$ did not appear in (1).\n\nNow take the total sum of (1) when $k = k_1, k_2, \\dots, k_t$, we get $s \\cdot A > t$. Similarly, taking the total sum of (3) when $k = k_1, k_2, \\dots, k_t$ gives $(t-s) \\cdot B > t$. But $A + B > t(\\frac{1}{s} + \\frac{1}{t-s}) \\ge 4$. This leads to a contradiction. The problem is proved.",
          "pages": [
            "P0"
          ],
          "status": "complete"
        }
      ],
      "statement_images": [],
      "statement_latex": "Let $n$ be a positive integer. Let $x_1, x_2, \\dots, x_{2n}$ be $2n$ nonnegative real numbers such that $x_1 + x_2 + \\dots + x_{2n} = 4$. Prove that there exist nonnegative integers $p, q$ such that $q \\le n-1$, and that\n\n$$\n\\sum_{i=1}^{q} x_{p+2i-1} \\le 1, \\quad \\sum_{i=q+1}^{n-1} x_{p+2i} \\le 1.\n$$\n\n*Remark 1: the subscripts are understood modulo $2n$, i.e. if $k \\equiv \\ell \\pmod{2n}$, then $x_k = x_\\ell$.*\n\n*Remark 2: If $q = 0$, then the first sum is considered as 0; if $q = n-1$, then the second sum is considered as 0.*"
    }
  ]
}